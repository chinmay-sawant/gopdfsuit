# Benchmark Results - v1.26 Optimized

This report summarizes the performance metrics of the **GoPdfSuit** API after Phase 1 and Phase 2 optimizations (Logger removal, Semaphore tuning to 100, scratch buffer pooling, and `sprintf` elimination).

## System Information

- **CPU**: 13th Gen Intel(R) Core(TM) i7-13700HX (16 Cores, 24 Threads)
- **Environment**: Local Linux (WSL2)
- **Optimizations Active**:
  - Gin Logger Disabled
  - Concurrency Semaphore: 100
  - Release Mode Enforced
  - XRef Loop Sprintf Elimination
  - Font Registry Pre-sizing

---

## Test Scenarios & Results

| Test Scenario       | Total Req | Throughput (req/s) | Avg Latency | p95 Latency | p99 Latency | Status  |
| :------------------ | :-------- | :----------------- | :---------- | :---------- | :---------- | :------ |
| **Smoke & Load**    | 81        | 2.64               | 23.38ms     | 13.59ms     | 404.05ms    | ✅ PASS |
| **Spike (100 VUs)** | 7,643     | 76.25              | 50.96ms     | 91.59ms     | 885.36ms    | ✅ PASS |
| **Soak (10 VUs)**   | 594       | 4.86               | 33.87ms     | 377.07ms    | 423.47ms    | ✅ PASS |

---

## Improvement Comparison (v1.26 vs v1.26 Optimized)

| Metric (Spike Test) | v1.26 (Original) | v1.26 Optimized | Change               |
| :------------------ | :--------------- | :-------------- | :------------------- |
| **Throughput**      | 69.54 req/s      | **76.25 req/s** | +9.6%                |
| **Avg Latency**     | 98.65ms          | **50.96ms**     | **-48%** (2x Faster) |
| **p95 Latency**     | 727.96ms         | **91.59ms**     | **-87%** (8x Faster) |
| **p99 Latency**     | 1,260.00ms       | **885.36ms**    | **-30%**             |

### Analysis

1.  **Latency Reduction**: The removal of the Gin Logger (which serializes stdout writes) and the increase in the concurrency semaphore from 24/48 to 100 drastically reduced wait times. This is most visible in the **p95 latency**, which dropped from **727ms to 91ms**.
2.  **Throughput Cap**: The throughput is still largely limited by the k6 test configuration (fixed VU count + `sleep` calls). However, the system is now handling ~10% more concurrent requests with much tighter latency bounds.
3.  **Efficiency**: The `sprintf` elimination in the XRef table generation has reduced allocation churn in the hot path, making p99 more stable.

---

## Conclusion

The API is now significantly more responsive under load. The "tail latency" (p95/p99) has been brought under control, ensuring that even under spikes, most users receive their PDFs in under 100ms (p95).
